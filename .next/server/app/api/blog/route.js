(()=>{var e={};e.id=778,e.ids=[778],e.modules={846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},4870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},9294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},3033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},5511:e=>{"use strict";e.exports=require("crypto")},1337:(e,r,t)=>{"use strict";t.r(r),t.d(r,{patchFetch:()=>N,routeModule:()=>v,serverHooks:()=>E,workAsyncStorage:()=>w,workUnitAsyncStorage:()=>y});var s={};t.r(s),t.d(s,{DELETE:()=>x,GET:()=>g,PATCH:()=>f,POST:()=>m});var n=t(2706),o=t(8203),a=t(5994),i=t(5511);let u=require("@aws-sdk/client-s3"),c=require("@prisma/client");var p=t(9187);let l=new c.PrismaClient,d=new u.S3Client({region:process.env.AWS_REGION,credentials:{accessKeyId:process.env.AWS_ACCESS_KEY,secretAccessKey:process.env.AWS_SECRET_KEY}});async function g(){try{let e=await l.blog.findMany();return p.NextResponse.json(e,{status:200})}catch(e){return console.error("Error fetching blogs:",e),p.NextResponse.json({error:"Internal server error"},{status:500})}}async function m(e){try{let r=await e.formData(),t=r.get("title"),s=r.get("content"),n="true"===r.get("reverse"),o=r.get("file");if(!t||!s||!o)return p.NextResponse.json({error:"Title, content, and image are required"},{status:400});let a=`${(0,i.randomUUID)()}-${o.name}`,c=Buffer.from(await o.arrayBuffer());await d.send(new u.PutObjectCommand({Bucket:process.env.AWS_BUCKET_NAME,Key:a,Body:c,ContentType:o.type}));let g=`https://${process.env.AWS_BUCKET_NAME}.s3.${process.env.AWS_REGION}.amazonaws.com/${a}`,m=await l.blog.create({data:{title:t,content:s,image:g,reverse:n}});return p.NextResponse.json(m,{status:201})}catch(e){return console.error("Error creating blog:",e),p.NextResponse.json({error:"Internal server error"},{status:500})}}async function f(e){try{let r;let t=await e.formData(),s=t.get("id"),n=t.get("title"),o=t.get("content"),a="true"===t.get("reverse"),c=t.get("file");if(!s)return p.NextResponse.json({error:"Blog ID is required"},{status:400});if(c){let e=`${(0,i.randomUUID)()}-${c.name}`,t=Buffer.from(await c.arrayBuffer());await d.send(new u.PutObjectCommand({Bucket:process.env.AWS_BUCKET_NAME,Key:e,Body:t,ContentType:c.type})),r=`https://${process.env.AWS_BUCKET_NAME}.s3.${process.env.AWS_REGION}.amazonaws.com/${e}`}let g=await l.blog.update({where:{id:Number(s)},data:{title:n,content:o,image:r??void 0,reverse:a}});return p.NextResponse.json(g,{status:200})}catch(e){return console.error("Error updating blog:",e),p.NextResponse.json({error:"Internal server error"},{status:500})}}async function x(e){try{let{id:r}=await e.json();if(!r)return p.NextResponse.json({error:"Blog ID is required"},{status:400});let t=await l.blog.findUnique({where:{id:Number(r)}});if(!t)return p.NextResponse.json({error:"Blog not found"},{status:404});let s=t.image.split("/").pop();return s&&await d.send(new u.DeleteObjectCommand({Bucket:process.env.AWS_BUCKET_NAME,Key:s})),await l.blog.delete({where:{id:Number(r)}}),p.NextResponse.json({message:"Blog deleted successfully"},{status:200})}catch(e){return console.error("Error deleting blog:",e),p.NextResponse.json({error:"Internal server error"},{status:500})}}let v=new n.AppRouteRouteModule({definition:{kind:o.RouteKind.APP_ROUTE,page:"/api/blog/route",pathname:"/api/blog",filename:"route",bundlePath:"app/api/blog/route"},resolvedPagePath:"/Users/Deadpool/Hydroleaf_frontend/src/app/api/blog/route.tsx",nextConfigOutput:"",userland:s}),{workAsyncStorage:w,workUnitAsyncStorage:y,serverHooks:E}=v;function N(){return(0,a.patchFetch)({workAsyncStorage:w,workUnitAsyncStorage:y})}},6487:()=>{},8335:()=>{}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[638,452],()=>t(1337));module.exports=s})();