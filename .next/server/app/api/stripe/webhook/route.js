(()=>{var e={};e.id=287,e.ids=[287],e.modules={846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},4870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},9294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},3033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},9646:e=>{"use strict";e.exports=require("child_process")},5511:e=>{"use strict";e.exports=require("crypto")},4735:e=>{"use strict";e.exports=require("events")},1630:e=>{"use strict";e.exports=require("http")},5591:e=>{"use strict";e.exports=require("https")},8354:e=>{"use strict";e.exports=require("util")},3444:(e,r,t)=>{"use strict";t.r(r),t.d(r,{patchFetch:()=>S,routeModule:()=>T,serverHooks:()=>R,workAsyncStorage:()=>c,workUnitAsyncStorage:()=>I});var s={};t.r(s),t.d(s,{POST:()=>_});var i=t(2706),o=t(8203),n=t(5994),E=t(9187),p=t(9824),a=t(5600),u=t(8481);let _=async e=>{try{let r;let t=await e.text(),s=e.headers.get("stripe-signature");try{r=u.n.webhooks.constructEvent(t,s,p._.STRIPE_WEBHOOK_SECRET_KEY)}catch(e){return E.NextResponse.json({error:{message:`Webhook Error - ${e}`}},{status:400})}let i=r.data.object;return"customer.subscription.created"===r.type&&await a.A.user.update({where:{stripeCustomerId:i.customer},data:{isActive:!0}}),E.NextResponse.json({received:!0})}catch{return E.NextResponse.json({error:{message:"Method Not Allowed"}},{status:405}).headers.set("Allow","POST")}},T=new i.AppRouteRouteModule({definition:{kind:o.RouteKind.APP_ROUTE,page:"/api/stripe/webhook/route",pathname:"/api/stripe/webhook",filename:"route",bundlePath:"app/api/stripe/webhook/route"},resolvedPagePath:"C:\\Users\\Admin\\New folder (2)\\hydroleaf\\src\\app\\api\\stripe\\webhook\\route.ts",nextConfigOutput:"",userland:s}),{workAsyncStorage:c,workUnitAsyncStorage:I,serverHooks:R}=T;function S(){return(0,n.patchFetch)({workAsyncStorage:c,workUnitAsyncStorage:I})}},6487:()=>{},8335:()=>{},5600:(e,r,t)=>{"use strict";t.d(r,{A:()=>i});let s=require("@prisma/client"),i=global.prisma||new s.PrismaClient},8481:(e,r,t)=>{"use strict";t.d(r,{n:()=>o});var s=t(6993),i=t(9824);let o=new s.A(i._.STRIPE_SECRET_KEY,{apiVersion:"2024-12-18.acacia"})},9824:(e,r,t)=>{"use strict";t.d(r,{_:()=>o});var s=t(1115),i=t(379);let o=(0,s.w)({server:{DATABASE_URL:i.z.string().min(1),APP_URL:i.z.string().url().min(1),GOOGLE_SITE_VERIFICATION_ID:i.z.string().optional(),GITHUB_ID:i.z.string().min(1),GITHUB_SECRET:i.z.string().min(1),NEXTAUTH_URL:i.z.string().url().optional(),NEXTAUTH_SECRET:i.z.string().min(1),STRIPE_SECRET_KEY:i.z.string().min(1),STRIPE_WEBHOOK_SECRET_KEY:i.z.string().min(1),STRIPE_SUBSCRIPTION_PRICE_ID:i.z.string().min(1)},client:{NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY:i.z.string().min(1)},runtimeEnv:{DATABASE_URL:process.env.DATABASE_URL,APP_URL:process.env.APP_URL,GOOGLE_SITE_VERIFICATION_ID:process.env.GOOGLE_SITE_VERIFICATION_ID,GITHUB_ID:process.env.GITHUB_ID,GITHUB_SECRET:process.env.GITHUB_SECRET,NEXTAUTH_URL:process.env.NEXTAUTH_URL,NEXTAUTH_SECRET:process.env.NEXTAUTH_SECRET,STRIPE_SECRET_KEY:process.env.STRIPE_SECRET_KEY,STRIPE_WEBHOOK_SECRET_KEY:process.env.STRIPE_WEBHOOK_SECRET_KEY,STRIPE_SUBSCRIPTION_PRICE_ID:process.env.STRIPE_SUBSCRIPTION_PRICE_ID,NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY:"your stripe publishable key"}})}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[440,226],()=>t(3444));module.exports=s})();